<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
     
  <meta http-equiv="Content-Type"
 content="text/html; charset=Windows-1252">
  <title>IBTMEXCW.H (C Windows) Source</title>
</head>
  <body bgcolor="#ffffff" text="#000000">
     
<h1><a name="scwinsource"></a><img src="./images/ibuttons.gif" alt=""
 border="0">
  IBTMEXCW.H (C Language) Source <a href="tmwi5ur7.html">Overview</a></h1>
    
<pre>/*---------------------------------------------------------------------<br> * Copyright (C) 1992-2002 Dallas Semiconductor/MAXIM Corporation.<br> * All rights Reserved. Printed in U.S.A.  This software is <br> * protected by copyright laws of the United States and of foreign<br> * countries.  This material may also be protected by patent laws <br> * of the United States and of foreign countries.  This software is <br> * furnished under a license agreement and/or a nondisclosure <br> * agreement and may only be used or copied in accordance with the <br> * terms of those agreements.  The mere transfer of this software <br> * does not imply any licenses of trade secrets, proprietary <br> * technology, copyrights, patents, trademarks, maskwork rights, <br> * or any other form of intellectual property whatsoever. Dallas <br> * Semiconductor retains all ownership rights.<br> *---------------------------------------------------------------------<br> * TMEX API header file - IBTMEXCW.H<br> */<br></pre>
<pre>/* includes */<br>#include &lt;stdlib.h&gt;<br>#include &lt;string.h&gt;<br>#include &lt;ctype.h&gt;<br>#include &lt;windows.h&gt;<br></pre>
<pre>/* type defs */<br>typedef unsigned char  uchar;<br>typedef unsigned short ushort;<br>typedef unsigned long  ulong;<br></pre>
<pre>/* typedef structures sent back by TMEX routines */<br></pre>
<pre>/* FileEntry holds TMEX file info */<br>typedef struct      <br>{<br>   uchar name[4];<br>   uchar extension;<br>   uchar startpage;<br>   uchar numpages;<br>   uchar attrib;<br>   uchar bitmap[32];<br>} FileEntry;<br></pre>
<pre>/* DirectoryPath holds information on TMEX file directories */<br>typedef struct<br>{<br>   uchar NumEntries;      /* number of entries in path 0-10 */<br>   char  Ref;             /* reference character '\' or '.' */<br>   char  Entries[10][4];  /* sub-directory entry names */                                          <br>} DirectoryPath;<br></pre>
<pre>/* Specification holds information on 1-Wire adapters or 1-Wire devices */<br>typedef struct <br>{<br>   unsigned short features[32];<br>   char description[255];<br>} Specification;<br></pre>
<pre>struct DirNumInfo // Holds info of each object in the Directory list<br>{  <br>   unsigned char Name[4];<br>   unsigned char Extension;<br>   char Attrib;<br>};<br></pre>
<pre>/* Error codes from TMEX functions */<br>#define    XNO_DEVICE             -1 <br>#define    XWRONG_TYPE            -2 <br>#define    XFILE_READ_ERR         -3 <br>#define    XBUFFER_TOO_SMALL      -4 <br>#define    XHANDLE_NOT_AVAIL      -5  <br>#define    XFILE_NOT_FOUND        -6 <br>#define    XREPEAT_FILE           -7 <br>#define    XHANDLE_NOT_USED       -8 <br>#define    XFILE_WRITE_ONLY       -9 <br>#define    XOUT_OF_SPACE          -10 <br>#define    XFILE_WRITE_ERR        -11 <br>#define    XFILE_READ_ONLY        -12 <br>#define    XFUNC_NOT_SUP          -13 <br>#define    XBAD_FILENAME          -14 <br>#define    XCANT_DEL_READ_ONLY    -15 <br>#define    XHANDLE_NOT_EXIST      -16 <br>#define    XONE_WIRE_PORT_ERROR   -17 <br>#define    XINVALID_DIRECTORY     -18 <br>#define    XDIRECTORY_NOT_EMPTY   -19 <br>#define    XUNABLE_TO_CREATE_DIR  -20 <br>#define    XNO_PROGRAM_JOB        -21 <br>#define    XPROGRAM_WRITE_PROTECT -22<br>#define    XNON_PROGRAM_PARTS     -23 <br>#define    XADDFILE_TERMINATED    -24 <br>#define    XTIMEOUT               -25 <br>#define    XINVALID_ARGUMENT      -26 <br>#define    XBAD_ACK               -27 <br>#define    XINVALID_SESSION       -200<br>#define    XNO_BASDRV_FOUND       -201<br></pre>
<pre>/* Basic physical level error codes  */<br>#define    BPORT_NOT_INITIALIZED   -1 <br>#define    BPORT_NOT_EXIST         -2 <br>#define    BNO_SUCH_FUNCTION       -3 <br></pre>
<pre>/* Transport level error codes  */<br>#define    TERROR_READ_WRITE       -4 <br>#define    TBUFFER_TOO_SMALL       -5 <br>#define    TDEVICE_TOO_SMALL       -6 <br>#define    TNO_DEVICE              -7 <br>#define    TBLOCK_TOO_BIG          -8 <br>#define    TWRONG_TYPE             -9 <br>#define    TPAGE_REDIRECTED        -10<br>#define    TPROGRAM_NOT_POSSIBLE   -11<br>#define    BCOM_FAILURE            -12<br>#define    BCOM_EVENT              -13<br></pre>
<pre>/* other  */<br>#define    GENERAL_FAIL            -2 <br>#define    BAD_ARGUMENT            50<br>#define    NO_DRIVERS              51<br>#define    KEY_ABORT               52<br>#define    OUT_MEMORY              53<br>#define    NORMAL_EXIT             0<br></pre>
<pre>#define    TRUE                    1<br>#define    FALSE                   0<br>#define    DIR_READ                1<br>#define    DIR_SET                 0<br>#define    DIR_REMOVE              1<br>#define    DIR_MAKE                0<br></pre>
<pre>// for TMOneWireLevel<br>#define    LEVEL_NORMAL            0<br>#define    LEVEL_STRONG_PULLUP     1<br>#define    LEVEL_BREAK             2<br>#define    LEVEL_PROGRAM           3  <br>#define    PRIMED_NONE             0<br>#define    PRIMED_BIT              1<br>#define    PRIMED_BYTE             2        <br>#define    LEVEL_READ              1<br>#define    LEVEL_SET               0<br></pre>
<pre><br>#ifdef __cplusplus<br>   extern "C" {<br></pre>
<pre>// Session Layer<br>__declspec(dllimport) long pascal  TMExtendedStartSession(short, short, void *);<br>__declspec(dllimport) long pascal  TMStartSession(short);<br>__declspec(dllimport) short pascal TMValidSession(long);<br>__declspec(dllimport) short pascal TMEndSession(long);<br></pre>
<pre>// File Operations Layer<br>__declspec(dllimport) short pascal TMFirstFile(long, void *, FileEntry *);<br>__declspec(dllimport) short pascal TMNextFile(long, void *, FileEntry *);<br>__declspec(dllimport) short pascal TMOpenFile(long, void *, FileEntry *);<br>__declspec(dllimport) short pascal TMCreateFile(long, void *, short *, FileEntry *);<br>__declspec(dllimport) short pascal TMCloseFile(long, void *, short);<br>__declspec(dllimport) short pascal TMReadFile(long, void *, short, unsigned char*, short);<br>__declspec(dllimport) short pascal TMWriteFile(long, void *, short, unsigned char *, short);<br>__declspec(dllimport) short pascal TMDeleteFile(long, void *, FileEntry *);<br>__declspec(dllimport) short pascal TMFormat(long, void *);<br>__declspec(dllimport) short pascal TMAttribute(long, void *, short, FileEntry *);<br>__declspec(dllimport) short pascal TMReNameFile(long, void *, short, FileEntry *);<br>__declspec(dllimport) short pascal TMChangeDirectory(long, void *, short, DirectoryPath *);<br>__declspec(dllimport) short pascal TMDirectoryMR(long, void *, short, FileEntry *);<br>__declspec(dllimport) short pascal TMCreateProgramJob(long, void *);<br>__declspec(dllimport) short pascal TMDoProgramJob(long, void *);<br>__declspec(dllimport) short pascal TMWriteAddFile(long, void *, short, short, short, unsigned char *, short);<br>__declspec(dllimport) short pascal TMTerminateAddFile(long, void *, FileEntry *);<br>__declspec(dllimport) short pascal TMGetFamilySpec(long, void *, Specification *);<br>__declspec(dllimport) short pascal Get_Version(char *);<br></pre>
<pre>// Transport Layer<br>__declspec(dllimport) short pascal TMReadPacket(long, void *, short, unsigned char *, short);<br>__declspec(dllimport) short pascal TMWritePacket(long, void *, short, unsigned char *, short);<br>__declspec(dllimport) short pascal TMBlockIO(long, unsigned char far *, short);<br>__declspec(dllimport) short pascal TMExtendedReadPage(long, void *, short, unsigned char *, short);<br>__declspec(dllimport) short pascal TMProgramByte(long, void *, short, short, short, short *, short);<br>__declspec(dllimport) short pascal TMProgramBlock(long, void *, unsigned char *, short, short, short *);<br>__declspec(dllimport) short pascal TMCRC(short, unsigned char *, unsigned short, short);<br></pre>
<pre>// Network Layer<br>__declspec(dllimport) short pascal TMFirst(long, void *);<br>__declspec(dllimport) short pascal TMNext(long, void *);<br>__declspec(dllimport) short pascal TMAccess(long, void *);<br>__declspec(dllimport) short pascal TMStrongAccess(long, void *);<br>__declspec(dllimport) short pascal TMStrongAlarmAccess(long, void *);<br>__declspec(dllimport) short pascal TMOverAccess(long, void *);<br>__declspec(dllimport) short pascal TMRom(long, void *, short *);<br>__declspec(dllimport) short pascal TMFirstAlarm(long, void *);<br>__declspec(dllimport) short pascal TMNextAlarm(long, void *);<br>__declspec(dllimport) short pascal TMFamilySearchSetup(long, void *, short);<br>__declspec(dllimport) short pascal TMSkipFamily(long, void *);<br>__declspec(dllimport) short pascal TMAutoOverDrive(long, void *, short);<br>__declspec(dllimport) short pascal TMSearch(long, void *, short, short, short);<br></pre>
<pre><br>// Hardware Specific Layer<br>__declspec(dllimport) short pascal TMSetup(long);<br>__declspec(dllimport) short pascal TMTouchByte(long, short);<br>__declspec(dllimport) short pascal TMTouchReset(long);<br>__declspec(dllimport) short pascal TMTouchBit(long, short);<br>__declspec(dllimport) short pascal TMProgramPulse(long);<br>__declspec(dllimport) short pascal TMOneWireLevel(long, short, short, short);<br>__declspec(dllimport) short pascal TMOneWireCom(long, short, short);<br>__declspec(dllimport) short pascal TMClose(long);<br>__declspec(dllimport) short pascal TMGetTypeVersion(short, char *);<br>__declspec(dllimport) short pascal TMBlockStream(long, unsigned char far *, short);<br>__declspec(dllimport) short pascal TMReadDefaultPort(short *, short *);<br>__declspec(dllimport) short pascal TMGetAdapterSpec(long, void *, Specification *);<br></pre>
<pre>}<br>#else<br></pre>
<pre>// Session Layer<br>extern long  far pascal TMExtendedStartSession(short, short, void far *);<br>extern long  far pascal TMStartSession(short);<br>extern short far pascal TMValidSession(long); <br>extern short far pascal TMEndSession(long); <br></pre>
<pre>// File Operations Layer<br>extern short far pascal TMFirstFile(long, void far *, FileEntry far *); <br>extern short far pascal TMNextFile(long, void far *, FileEntry far *);<br>extern short far pascal TMOpenFile(long, void far *, FileEntry far *);<br>extern short far pascal TMCreateFile(long, void far *, short far *, FileEntry far *);<br>extern short far pascal TMCloseFile(long, void far *, short);<br>extern short far pascal TMReadFile(long, void far *, short, uchar far *, short);<br>extern short far pascal TMWriteFile(long, void far *, short, uchar far *, short);<br>extern short far pascal TMDeleteFile(long, void far *, FileEntry far *);<br>extern short far pascal TMFormat(long, void far *);<br>extern short far pascal TMAttribute(long, void far *, short, FileEntry far *);<br>extern short far pascal TMReNameFile(long, void far *, short, FileEntry far *); <br>extern short far pascal TMChangeDirectory(long, void far *, short, DirectoryPath far *); <br>extern short far pascal TMDirectoryMR(long, void far *, short, FileEntry far *);<br>extern short far pascal TMCreateProgramJob(long, void far *);<br>extern short far pascal TMDoProgramJob(long, void far *);<br>extern short far pascal TMWriteAddFile(long, void far *, short, short, short, uchar far *, short);<br>extern short far pascal TMTerminateAddFile(long, void far *, FileEntry far *);<br>extern short far pascal TMGetFamilySpec(long, void *, Specification *);<br>extern short far pascal Get_Version(char far *);<br></pre>
<pre>// Transport Layer<br>extern short far pascal TMReadPacket(long, void far *, short, uchar far *, short);<br>extern short far pascal TMWritePacket(long, void far *, short, uchar far *, short);<br>extern short far pascal TMBlockIO(long, uchar far *, short);<br>extern short far pascal TMExtendedReadPage(long, void far *, short, uchar far *, short);<br>extern short far pascal TMProgramByte(long, void far *, short, short, short, short far *, short);<br>extern short far pascal TMProgramBlock(long, void far *, unsigned char far *, short, short, short far *);<br>extern short far pascal TMCRC(short, unsigned char far *, unsigned short, short);<br></pre>
<pre>// Network Layer<br>extern short far pascal TMSkipFamily(long, void far *); <br>extern short far pascal TMFamilySearchSetup(long, void far *, short); <br>extern short far pascal TMFirst(long, void far *);<br>extern short far pascal TMNext(long, void far *);<br>extern short far pascal TMAccess(long, void far *);<br>extern short far pascal TMOverAccess(long, void far *);<br>extern short far pascal TMStrongAccess(long, void far *);<br>extern short far pascal TMStrongAlarmAccess(long, void far *);<br>extern short far pascal TMRom(long, void far *, short far *);<br>extern short far pascal TMFirstAlarm(long, void far *);<br>extern short far pascal TMNextAlarm(long, void far *);  <br>extern short far pascal TMAutoOverDrive(long, void far *, short);<br>extern short far pascal TMSearch(long, void far *, short, short, short);<br></pre>
<pre>// Hardware Specific Layer<br>extern short far pascal TMSetup(long);<br>extern short far pascal TMTouchByte(long, short);<br>extern short far pascal TMTouchReset(long);<br>extern short far pascal TMTouchBit(long, short);<br>extern short far pascal TMProgramPulse(long); <br>extern short far pascal TMOneWireLevel(long, short, short, short); <br>extern short far pascal TMOneWireCom(long, short, short); <br>extern short far pascal TMClose(long);<br>extern short far pascal TMGetTypeVersion(short,char far *); <br>extern short far pascal TMBlockStream(long, uchar far *, short);<br>extern short far pascal TMReadDefaultPort(short far *, short far *); <br>extern short far pascal TMGetAdapterSpec(long, void far *, Specification far *);<br></pre>
<pre>#endif<br></pre>
<pre><code><br></code></pre>
    
<p><b>See Also</b></p>
    
<p><a href="tmwi5ur7.html"><b>TMEX Windows Considerations</b></a>, <a
 href="spwi3z8l.html"><b>Delphi Windows Source</b></a>, <a
 href="svbw4xph.html"><b>Visual Basic Windows Source</b></a></p>
   <br>
 <br>
</body>
</html>
