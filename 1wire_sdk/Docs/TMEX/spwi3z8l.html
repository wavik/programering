<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
  
  <meta http-equiv="Content-Type"
 content="text/html; charset=Windows-1252">
  <title>iBTMEXPW.PAS (Delphi Windows) Source</title>
</head>
<body bgcolor="#ffffff" text="#000000">
<h1><a name="spwinsource"></a><img src="./images/ibuttons.gif" alt=""
 border="0">
 iBTMEXPW.PAS (Delphi) Source <a href="tmwi5ur7.html">Overview</a></h1>
<pre><code>{----------------------------------------------------------------------<br> | Copyright (C) 1992-2002 Dallas Semiconductor/MAXIM Corporation.<br> | All rights Reserved. Printed in U.S.A.  This software is <br> | protected by copyright laws of the United States and of foreign<br> | countries.  This material may also be protected by patent laws <br> | of the United States and of foreign countries.  This software is <br> | furnished under a license agreement and/or a nondisclosure <br> | agreement and may only be used or copied in accordance with the <br> | terms of those agreements.  The mere transfer of this software <br> | does not imply any licenses of trade secrets, proprietary <br> | technology, copyrights, patents, trademarks, maskwork rights, <br> | or any other form of intellectual property whatsoever. Dallas <br> | Semiconductor retains all ownership rights.<br> |---------------------------------------------------------------------<br><br>   The TMEX API functions.<br>}<br>Unit iBTMEXPW;<br><br>Interface<br><br>Type<br>   FileEntry = record<br>      name : Array[0..3] of Char;<br>      extension : Byte;<br>      startpage : Byte;<br>      numpages  : Byte;<br>      attribute : Byte;<br>      BitMap : Array[0..31] of Byte;<br>   end;<br>   PFileEntry = ^FileEntry;<br>   DirectoryPath = record<br>      NumEntries : Byte;<br>      Ref : Char;<br>      Entries : Array[0..9,0..3] of Char;<br>   end;<br>   PDirectoryPath = ^DirectoryPath;<br>   Specification = record<br>      features : Array[0..31] of Byte;<br>      description : Array[0..254] of Char;<br>   end;<br> <br>Var<br>   StateBuf : Array[1..15360] of Byte;<br>   SHandle : Longint;<br>   CRC16 : Word;<br>   CRC8 :Byte;<br>Const<br>  { TMEX Error codes }<br>      XNO_DEVICE             = -1 ;<br>      XWRONG_TYPE            = -2 ;<br>      XFILE_READ_ERR         = -3 ;<br>      XBUFFER_TOO_SMALL      = -4 ;<br>      XHANDLE_NOT_AVAIL      = -5 ;<br>      XFILE_NOT_FOUND        = -6 ;<br>      XREPEAT_FILE           = -7 ;<br>      XHANDLE_NOT_USED       = -8 ;<br>      XFILE_WRITE_ONLY       = -9 ;<br>      XOUT_OF_SPACE          = -10 ;<br>      XFILE_WRITE_ERR        = -11 ;<br>      XFILE_READ_ONLY        = -12 ;<br>      XFUNC_NOT_SUP          = -13 ;<br>      XBAD_FILENAME          = -14 ;<br>      XCANT_DEL_READ_ONLY    = -15 ;<br>      XHANDLE_NOT_EXIST      = -16 ;<br>      XONE_WIRE_PORT_ERROR   = -17 ;<br>      XINVALID_DIRECTORY     = -18 ;<br>      XDIRECTORY_NOT_EMPTY   = -19 ;<br>      XUNABLE_TO_CREATE_DIR  = -20 ;<br>      XNO_PROGRAM_JOB        = -21 ;<br>      XPROGRAM_WRITE_PROTECT = -22 ;<br>      XNON_PROGRAM_PARTS     = -23 ;<br>      XADDFILE_TERMINATED    = -24 ;<br>      XTIMEOUT               = -25 ;<br>      XINVALID_ARGUMENT      = -26 ;<br>      XBAD_ACK               = -27 ;<br>      XINVALID_SESSION       = -200;<br>      XNO_BASDRV_FOUND       = -201;<br><br>{ Basic physical level error codes }<br>      BPORT_NOT_INITIALIZED  = -1 ;<br>      BPORT_NOT_EXIST        = -2 ;<br>      BNO_SUCH_FUNCTION      = -3 ;<br><br>{ Transport level error codes }<br>      TERROR_READ_WRITE      = -4 ;<br>      TBUFFER_TOO_SMALL      = -5 ;<br>      TDEVICE_TOO_SMALL      = -6 ;<br>      TNO_DEVICE             = -7 ;<br>      TBLOCK_TOO_BIG         = -8 ;<br>      TWRONG_TYPE            = -9 ;<br>      TPAGE_REDIRECTED       = -10;<br>      TPROGRAM_NOT_POSSIBLE  = -11;<br>      BCOM_FAILURE           = -12;<br>      BCOM_EVENT             = -13;<br>{ other }<br>      GENERAL_FAIL           = -2 ;<br></code></pre>
<pre><code></code><code></code><code>{Session Layer}<br>Function TMExtendedStartSession(P: SmallInt; T: SmallInt; Q: Pointer): LongInt; StdCall;<br>Function TMStartSession(N: SmallInt): SmallInt; StdCall;<br>Function TMValidSession(H: LongInt): SmallInt; StdCall;<br>Function TMEndSession(H: LongInt): SmallInt; StdCall;<br></code></pre>
<pre><code></code><code>{ File Operations Layer }<br>Function TMFirstFile(H: LongInt; P: Pointer; F: Pointer): SmallInt; StdCall;<br>Function TMNextFile(H: LongInt; P: Pointer; F: Pointer): SmallInt; StdCall;<br>Function TMOpenFile(H: LongInt; P: Pointer; F: Pointer): SmallInt; StdCall;<br>Function TMCreateFile(H: LongInt; P: Pointer; L: Pointer; F: Pointer): SmallInt; StdCall;<br>Function TMCloseFile(H: LongInt; P: Pointer; G: SmallInt): SmallInt; StdCall;<br>Function TMReadFile(H: LongInt; P: Pointer; G: SmallInt; F: Pointer; M: SmallInt): SmallInt; StdCall;<br>Function TMWriteFile(H: LongInt; P: Pointer; G: SmallInt; F: Pointer; M: SmallInt): SmallInt; StdCall;<br>Function TMDeleteFile(H: LongInt; P: Pointer; F: Pointer): SmallInt; StdCall;<br>Function TMFormat(H: LongInt; P: Pointer): SmallInt; StdCall;<br>Function TMAttribute(H: LongInt; P: Pointer; A: SmallInt; F: Pointer): SmallInt; StdCall;<br>Function TMReNameFile(H: LongInt; P: Pointer; A: SmallInt; F: Pointer): SmallInt; StdCall;<br>Function TMChangeDirectory(H: LongInt; P: Pointer; N: SmallInt; F: Pointer): SmallInt; StdCall;<br>Function TMDirectoryMR(H: LongInt; P: Pointer; N: SmallInt; F: Pointer): SmallInt; StdCall;<br>Function TMCreateProgramJob(H: LongInt; P: Pointer): SmallInt; StdCall;<br>Function TMDoProgramJob(H: LongInt; P: Pointer): SmallInt; StdCall;<br>Function TMWriteAddFile(H: LongInt; P: Pointer; G,O,S: SmallInt; F: Pointer; M: SmallInt): SmallInt; StdCall;<br>Function TMTerminateAddFile(H: Longint; P: Pointer; F: Pointer): Smallint; StdCall;<br>Function TMGetFamilySpec(H: Longint; P: Pointer; F: Pointer): Smallint; StdCall;<br>Function Get_Version(V: Pointer): SmallInt; StdCall;<br></code></pre>
<pre><code></code><code>{ Transport Layer }<br>Function TMReadPacket(H: LongInt; P: Pointer; G: SmallInt; D: Pointer; M: SmallInt): SmallInt; StdCall;<br>Function TMWritePacket(H: LongInt; P: Pointer; G: SmallInt; D: Pointer; L: SmallInt): SmallInt; StdCall;<br>Function TMBlockIO(H: Longint; P: Pointer; T: Pointer; N: Smallint ): Smallint; StdCall;<br>Function TMExtendedReadPage(H: LongInt; P: Pointer; G: SmallInt; D: Pointer; T: SmallInt): SmallInt; StdCall;<br>Function TMProgramByte(H: Longint; P: Pointer; M: Smallint; I : Pointer; N: Smallint; T:Pointer; Z: SmallInt): Smallint; StdCall;<br>Function TMProgramBlock(H: Longint; P: Pointer; W: Pointer; L: Smallint; A: SmallInt; B: Pointer): Smallint; StdCall;<br>Function TMCRC(L: SmallInt; P: Pointer; S: Word; T: Smallint): Smallint; StdCall;<br></code></pre>
<pre><code></code><code>{ Network Layer }<br>Function TMFirst(H: LongInt; P: Pointer): SmallInt; StdCall;<br>Function TMNext(H: LongInt; P: Pointer): SmallInt; StdCall;<br>Function TMAccess(H: LongInt; P: Pointer): SmallInt; StdCall;<br>Function TMStrongAccess(H: LongInt; P: Pointer): SmallInt; StdCall;<br>Function TMStrongAlarmAccess(H: LongInt; P: Pointer): SmallInt; StdCall;<br>Function TMOverAccess (H: Longint; P: Pointer): Smallint; StdCall;<br>Function TMRom(H: Longint; P: Pointer; D: Pointer): Smallint; StdCall;<br>Function TMFirstAlarm(H: Longint; P: Pointer): Smallint; StdCall;<br>Function TMNextAlarm (H: Longint; P: Pointer): Smallint; StdCall;<br>Function TMFamilySearchSetup(H: Longint; P: Pointer; G: Smallint): Smallint; StdCall;<br>Function TMSkipFamily (H: Longint; P: Pointer): Smallint; StdCall;<br>Function TMAutoOverDrive(H: LongInt; P: Pointer; M: SmallInt): SmallInt; StdCall;<br></code>Function TMSearch(H: LongInt; P: Pointer; R: SmallInt; PR: SmallInt; SC: SmallInt): SmallInt; StdCall;<br></pre>
<pre><code>{ Hardware Specific Layer }<br>Function TMSetup(H: LongInt): SmallInt; StdCall;<br>Function TMTouchByte(H: LongInt; B: SmallInt): SmallInt; StdCall;<br>Function TMTouchReset(H: LongInt): SmallInt; StdCall;<br>Function TMTouchBit(H: LongInt; B: SmallInt): SmallInt; StdCall;<br>Function TMProgramPulse(H: Longint): Smallint; StdCall;<br>Function TMOneWireLevel (H: Longint; O: SmallInt; L: SmallInt; P: SmallInt): SmallInt; StdCall;<br>Function TMOneWireCom (H: Longint; O: SmallInt; T: SmallInt): SmallInt; StdCall;<br>Function TMClose (H: Longint): Smallint; StdCall;<br>Function TMGetTypeVersion(N: SmallInt; V: Pointer): SmallInt; StdCall;<br>Function TMBlockStream(H: LongInt; P: Pointer; G: SmallInt): SmallInt; StdCall;<br>Function TMReadDefaultPort(P: Pointer; T: Pointer): SmallInt; StdCall;<br>Function TMGetAdapterSpec(H: LongInt; P: Pointer; S: Pointer): SmallInt; StdCall;<br></code></pre>
<code></code><code></code><code>Implementation</code><br>
<code></code>
<pre><code>{ Session Layer }<br>Function TMExtendedStartSession; External 'IBFS32.DLL';<br>Function TMStartSession; External 'IBFS32.DLL';<br>Function TMValidSession; External 'IBFS32.DLL';<br>Function TMEndSession; External 'IBFS32.DLL';<br></code></pre>
<pre><code></code><code>{ File Operations Layer }<br>Function TMFirstFile; External 'IBFS32.DLL';<br>Function TMNextFile; External 'IBFS32.DLL';<br>Function TMOpenFile; External 'IBFS32.DLL';<br>Function TMCreateFile; External 'IBFS32.DLL';<br>Function TMCloseFile; External 'IBFS32.DLL';<br>Function TMReadFile; External 'IBFS32.DLL';<br>Function TMWriteFile; External 'IBFS32.DLL';<br>Function TMDeleteFile; External 'IBFS32.DLL';<br>Function TMFormat; External 'IBFS32.DLL';<br>Function TMAttribute; External 'IBFS32.DLL';<br>Function TMReNameFile; External 'IBFS32.DLL';<br>Function TMChangeDirectory; External 'IBFS32.DLL';<br>Function TMDirectoryMR; External 'IBFS32.DLL';<br>Function TMCreateProgramJob; External 'IBFS32.DLL';<br>Function TMDoProgramJob; External 'IBFS32.DLL';<br>Function TMWriteAddFile; External 'IBFS32.DLL';<br>Function TMTerminateAddFile; External 'IBFS32.DLL';<br>Function TMGetFamilySpec; External 'IBFS32.DLL';<br>Function Get_Version; External 'IBFS32.DLL';<br></code></pre>
<pre><code></code><code></code><code>{ Transport Layer }<br>Function TMReadPacket; External 'IBFS32.DLL';<br>Function TMWritePacket; External 'IBFS32.DLL';<br>Function TMBlockIO; External 'IBFS32.DLL';<br>Function TMExtendedReadPage; External 'IBFS32.DLL';<br>Function TMProgramByte; External 'IBFS32.DLL';<br>Function TMProgramBlock; External 'IBFS32.DLL';<br>Function TMCRC; External 'IBFS32.DLL';<br></code></pre>
<pre><code></code><code></code><code>{ Network Layer }<br>Function TMFirst; External 'IBFS32.DLL';<br>Function TMNext; External 'IBFS32.DLL';<br>Function TMAccess; External 'IBFS32.DLL';<br>Function TMStrongAccess; External 'IBFS32.DLL';<br>Function TMStrongAlarmAccess; External 'IBFS32.DLL';<br>Function TMOverAccess; External 'IBFS32.DLL';<br>Function TMRom; External 'IBFS32.DLL';<br>Function TMFirstAlarm; External 'IBFS32.DLL';<br>Function TMNextAlarm; External 'IBFS32.DLL';<br>Function TMFamilySearchSetup; External 'IBFS32.DLL';<br>Function TMSkipFamily; External 'IBFS32.DLL';<br>Function TMAutoOverDrive; External 'IBFS32.DLL';<br>Function TMSearch; External 'IBFS32.DLL';<br></code></pre>
<pre><code></code><code>{ Hardware Specific Layer }<br>Function TMSetup; External 'IBFS32.DLL';<br>Function TMTouchByte; External 'IBFS32.DLL';<br>Function TMTouchReset; External 'IBFS32.DLL';<br>Function TMTouchBit; External 'IBFS32.DLL';<br>Function TMProgramPulse; External 'IBFS32.DLL';<br>Function TMOneWireLevel; External 'IBFS32.DLL';<br>Function TMOneWireCom; External 'IBFS32.DLL';<br>Function TMClose; External 'IBFS32.DLL';<br>Function TMGetTypeVersion; External 'IBFS32.DLL';<br>Function TMBlockStream; External 'IBFS32.DLL';<br>Function TMReadDefaultPort; External 'IBFS32.DLL';<br>Function TMGetAdapterSpec; External 'IBFS32.DLL';<br></code></pre>
<pre><code></code><code><br>End.</code></pre>
<p><b>See Also</b></p>
<p><a href="tmwi5ur7.html"><b>TMEX Windows Considerations</b></a>, <a
 href="scwi071h.html"><b>C Windows Source</b></a>, <a
 href="svbw4xph.html"><b>Visual Basic Windows Source</b></a></p>
<br>
<br>
</body>
</html>
