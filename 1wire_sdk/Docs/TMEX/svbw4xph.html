<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=Windows-1252">
  <title>iBTMEXBW.BAS (Visual Basic Windows) Source</title>
</head>
<body bgcolor="#ffffff" text="#000000">
<h1><a name="svbwinsource"></a><img src="./images/ibuttons.gif" alt=""
 border="0">
 iBTMEXBW.BAS (Visual Basic) Source <a href="tmwi5ur7.html">Overview</a></h1>
<pre>'//---------------------------------------------------------------------<br>'// Copyright (C) 1992-2002 Dallas Semiconductor/MAXIM Corporation.<br>'// All rights Reserved. Printed in U.S.A.  This software is<br>'// protected by copyright laws of the United States and of foreign<br>'// countries.  This material may also be protected by patent laws<br>'// of the United States and of foreign countries.  This software is<br>'// furnished under a license agreement and/or a nondisclosure<br>'// agreement and may only be used or copied in accordance with the<br>'// terms of those agreements.  The mere transfer of this software<br>'// does not imply any licenses of trade secrets, proprietary<br>'// technology, copyrights, patents, trademarks, maskwork rights,<br>'// or any other form of intellectual property whatsoever. Dallas<br>'// Semiconductor retains all ownership rights.<br>'//---------------------------------------------------------------------<br><br>' External DLL function declarations<br></pre>
<pre>'// Session Layer functions<br>Declare Function TMExtendedStartSession Lib "IBFS32.DLL" (ByVal PortNum As Integer, ByVal PortType As Integer, ByVal Reserved As Any) As Long<br>Declare Function TMValidSession Lib "IBFS32.DLL" (ByVal session_handle As Long) As Integer<br>Declare Function TMEndSession Lib "IBFS32.DLL" (ByVal session_handle As Long) As Integer<br></pre>
<pre>'// File Operations Layer functions<br>Declare Function TMFirstFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, fentry As Byte) As Integer<br>Declare Function TMNextFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, fentry As Byte) As Integer<br>Declare Function TMOpenFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, fentry As Byte) As Integer<br>Declare Function TMCreateFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, maxwrite As Integer, fentry As Byte) As Integer<br>Declare Function TMCloseFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal file_handle As Integer) As Integer<br>Declare Function TMReadFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal file_handle As Integer, read_buffer As Byte, ByVal max_read As Integer) As Integer<br>Declare Function TMWriteFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal file_handle As Integer, write_buffer As Byte, ByVal num_write As Integer) As Integer<br>Declare Function TMDeleteFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, fentry As Byte) As Integer<br>Declare Function TMFormat Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMAttribute Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal attrib As Integer, fentry As Byte) As Integer<br>Declare Function TMReNameFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal file_handle As Integer, fentry As Byte) As Integer<br>Declare Function TMChangeDirectory Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal operation As Integer, cd_buf As Byte) As Integer<br>Declare Function TMDirectoryMR Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal operation As Integer, fentry As Byte) As Integer<br>Declare Function TMCreateProgramJob Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMDoProgramJob Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMWriteAddFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal operation As Integer, ByVal offset As Integer, write_buffer As Byte, ByVal num_write As Integer) As Integer<br>Declare Function TMTerminateAddFile Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, fentry As Byte) As Integer<br>Declare Function TMGetFamilySpec Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, FamSpec As Byte) As Integer<br>Declare Function Get_Version Lib "IBFS32.DLL" (ByVal ID_buf$) As Integer<br></pre>
<pre>'// Transport Layer functions<br>Declare Function TMReadPacket Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal StartPg As Integer, ReadBuf As Byte, ByVal MaxRead As Integer) As Integer<br>Declare Function TMWritePacket Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal StartPg As Integer, WriteBuf As Byte, ByVal Writelen As Integer) As Integer<br>Declare Function TMBlockIO Lib "IBFS32.DLL" (ByVal session_handle As Long, tran_buffer As Byte, ByVal num_tran As Integer) As Integer<br>Declare Function TMExtendedReadPage Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal StartPg As Integer, ReadBuf As Byte, ByVal MSpace As Integer) As Integer<br>Declare Function TMProgramByte Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal WRByte As Integer, ByVal Addr As Integer, ByVal MSpace As Integer, Bits As Integer, ByVal Zeros As Integer) As Integer<br>Declare Function TMProgramBlock Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, WriteBuf As Byte, ByVal Length As Integer, ByVal Address As Integer, Bits As Integer) As Integer<br>Declare Function TMCRC Lib "IBFS32.DLL" (ByVal Length As Integer, Buf As Byte, ByVal Seed As Integer, ByVal CRCType As Integer) As Integer<br></pre>
<pre>'// Network Layer functions<br>Declare Function TMFirst Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMNext Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMAccess Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMStrongAccess Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMStrongAlarmAccess Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMOverAccess Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMRom Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ROM As Integer) As Integer<br>Declare Function TMFirstAlarm Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMNextAlarm Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMFamilySearchSetup Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ByVal family_type As Integer) As Integer<br>Declare Function TMSkipFamily Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte) As Integer<br>Declare Function TMAutoOverDrive Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, Mode As Integer) As Integer<br>Declare Function TMSearch Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, ResetSearch As Integer, ByVal PerformReset As Integer, ByVal SrchCmd As Integer) As Integer<br></pre>
<pre>'// Hardware Specific Layer functions<br>Declare Function TMSetup Lib "IBFS32.DLL" (ByVal session_handle As Long) As Integer<br>Declare Function TMTouchByte Lib "IBFS32.DLL" (ByVal session_handle As Long, ByVal outbyte As Integer) As Integer<br>Declare Function TMTouchReset Lib "IBFS32.DLL" (ByVal session_handle As Long) As Integer<br>Declare Function TMTouchBit Lib "IBFS32.DLL" (ByVal session_handle As Long, ByVal outbit As Integer) As Integer<br>Declare Function TMProgramPulse Lib "IBFS32.DLL" (ByVal session_handle As Long) As Integer<br>Declare Function TMOneWireLevel Lib "IBFS32.DLL" (ByVal session_handle As Long, ByVal operation As Integer, ByVal LevelMode As Integer, ByVal primed As Integer) As Integer<br>Declare Function TMOneWireCom Lib "IBFS32.DLL" (ByVal session_handle As Long, ByVal operation As Integer, ByVal TimeMode As Integer) As Integer<br>Declare Function TMClose Lib "IBFS32.DLL" (ByVal session_handle As Long) As Integer<br>Declare Function TMGetTypeVersion Lib "IBFS32.DLL" (ByVal HSType As Integer, ByVal ID_buf$) As Integer<br>Declare Function TMBlockStream Lib "IBFS32.DLL" (ByVal session_handle As Long, tran_buffer As Byte, ByVal num_tran As Integer) As Integer<br>Declare Function TMReadDefaultPort Lib "IBFS32.DLL" (PortNum As Integer, PortType As Integer) As Integer<br>Declare Function TMGetAdapterSpec Lib "IBFS32.DLL" (ByVal session_handle As Long, state_buffer As Byte, AdapterSpec As Byte) As Integer<br></pre>
<pre><br></pre>
<p><b>See Also</b></p>
<p><a href="tmwi5ur7.html"><b>TMEX Windows Considerations</b></a>, <a
 href="scwi071h.html"><b>C Windows Source</b></a>, <a
 href="spwi3z8l.html"><b>Delphi Windows Source</b></a></p>
<br>
</body>
</html>
